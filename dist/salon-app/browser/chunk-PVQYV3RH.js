import{a as D,b as O}from"./chunk-RTAZCOS2.js";import{q as L,w as M}from"./chunk-6EJ6NX7I.js";import{Ab as u,Ga as a,Jc as I,Kc as E,Nb as s,Ob as m,Pa as f,Pb as h,Qb as _,Va as y,Yb as b,Za as k,ca as x,da as g,mb as v,nb as r,ob as n,pb as p,vc as C,wb as S,wc as w,yb as c,zc as U}from"./chunk-2QRLZU6U.js";var A=(l,t,e)=>({"bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400 border-emerald-300 dark:border-emerald-700":l,"bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400 border-amber-300 dark:border-amber-700":t,"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-400 border-gray-300 dark:border-gray-700":e}),F=(l,t,e)=>({"bg-emerald-500":l,"bg-amber-500":t,"bg-gray-500":e});function j(l,t){if(l&1){let e=S();r(0,"tr",22)(1,"td",23)(2,"div",24)(3,"div",25),s(4),n(),r(5,"div",4)(6,"span",26),s(7),n(),r(8,"span",27),s(9),n()()()(),r(10,"td",28),s(11),n(),r(12,"td",28),s(13),n(),r(14,"td",23)(15,"span",29),c("click",function(){let d=x(e).index,o=u();return g(o.toggleStatus(o.getOriginalIndex(d)))}),p(16,"span",30),s(17),n()(),r(18,"td",31)(19,"div",32)(20,"button",33),c("click",function(){let d=x(e).index,o=u();return g(o.edit(o.getOriginalIndex(d)))}),s(21,"Manage"),n(),r(22,"button",34),c("click",function(){let d=x(e).index,o=u();return g(o.delete(o.getOriginalIndex(d)))}),s(23,"Delete"),n()()()()}if(l&2){let e=t.$implicit,i=u();a(4),h(" ",i.getName(e)),a(3),m(e.name),a(2),m(e.email),a(2),m(e.role),a(2),m(e.last),a(2),v("ngClass",b(8,A,e.active==="Active",e.active==="Pending",e.active==="Inactive")),a(),v("ngClass",b(12,F,e.active==="Active",e.active==="Pending",e.active==="Inactive")),a(),h(" ",e.active," ")}}var T=class l{constructor(t,e,i){this.userSrv=t;this.dialog=e;this.confirmationService=i}users=[];displayedUsers=[];filter="all";search="";loading=!1;itemsPerLoad=10;currentLoadedCount=0;modalSubscription;ngOnInit(){this.users=this.userSrv.list(),this.loadInitialUsers(),this.modalSubscription=this.userSrv.onOpenModal.subscribe(t=>{t!==null&&this.openDialog(t)})}ngOnDestroy(){this.modalSubscription?.unsubscribe()}loadInitialUsers(){this.currentLoadedCount=Math.min(this.itemsPerLoad,this.filtered.length),this.displayedUsers=this.filtered.slice(0,this.currentLoadedCount)}loadMoreUsers(){this.loading||this.currentLoadedCount>=this.filtered.length||(this.loading=!0,setTimeout(()=>{let t=Math.min(this.currentLoadedCount+this.itemsPerLoad,this.filtered.length);this.displayedUsers=this.filtered.slice(0,t),this.currentLoadedCount=t,this.loading=!1},300))}onScroll(t){let e=t.target;e.scrollHeight-e.scrollTop<=e.clientHeight+50&&this.loadMoreUsers()}openDialog(t){this.dialog.open(O,{width:"600px",maxWidth:"90vw",data:t,panelClass:"custom-dialog-container",disableClose:!1}).afterClosed().subscribe(i=>{i&&(this.users=this.userSrv.list(),this.loadInitialUsers())})}get filtered(){let t=[...this.users];if(this.filter==="active"&&(t=t.filter(e=>e.active==="Active")),this.search){let e=this.search.toLowerCase();t=t.filter(i=>i.name.toLowerCase().includes(e)||i.email.toLowerCase().includes(e)||i.role.toLowerCase().includes(e))}return t}openAdd(){this.userSrv.openAdd()}edit(t){this.userSrv.openEdit(t)}delete(t){let e=this.users[t];this.confirmationService.confirm({title:"Delete User",message:`Are you sure you want to delete ${e.name}? This action cannot be undone.`,confirmText:"Delete",type:"danger"}).subscribe(i=>{i&&(this.userSrv.remove(t),this.users=this.userSrv.list(),this.loadInitialUsers())})}toggleStatus(t){this.userSrv.toggleStatus(t),this.displayedUsers=this.filtered.slice(0,this.currentLoadedCount)}getOriginalIndex(t){let e=this.displayedUsers[t];return this.users.findIndex(i=>i===e)}getName(t){return t.name.split(" ").map(e=>e[0]).slice(0,2).join("").toUpperCase()}static \u0275fac=function(e){return new(e||l)(f(D),f(L),f(M))};static \u0275cmp=y({type:l,selectors:[["app-users"]],decls:38,vars:4,consts:[[1,"grid","grid-cols-1","xl:grid-cols-3","gap-4"],[1,"xl:col-span-3"],[1,"rounded-2xl","border","border-gray-200","dark:border-slate-800","bg-white","dark:bg-slate-900","overflow-hidden","flex","flex-col","shadow-sm","transition-colors"],[1,"flex","items-center","justify-between","px-4","py-3","border-b","border-gray-200","dark:border-slate-800"],[1,"flex","flex-col"],[1,"text-base","font-semibold","tracking-tight","text-slate-900","dark:text-slate-100"],[1,"text-sm","text-slate-600","dark:text-slate-400"],[1,"flex","items-center","gap-2"],[1,"hidden","sm:inline-flex","items-center","gap-1.5","rounded-lg","border","border-gray-300","dark:border-slate-700","px-3","py-1.5","text-xs","text-slate-700","dark:text-slate-300","hover:bg-gray-100","dark:hover:bg-slate-800",3,"click"],["name","funnel",1,"w-3.5","h-3.5"],[1,"inline-flex","items-center","gap-1.5","rounded-lg","bg-sky-600","hover:bg-sky-700","text-white","text-xs","font-medium","px-3","py-1.5","transition",3,"click"],["name","plus",1,"w-3.5","h-3.5"],[1,"overflow-auto",2,"max-height","calc(100dvh - 386px)",3,"scroll"],[1,"w-full","text-sm","overflow-auto"],[1,"bg-gray-50","dark:bg-slate-900","border-b","border-gray-200","dark:border-slate-800","text-xs","text-slate-700","dark:text-slate-300","sticky","top-0"],[1,"text-left","font-medium","py-2.5","px-4"],[1,"text-right","font-medium","py-2.5","px-4"],[1,"divide-y","divide-gray-200","dark:divide-slate-800"],["class","hover:bg-gray-50 dark:hover:bg-slate-800/50",4,"ngFor","ngForOf"],[1,"flex","justify-center","py-4","text-center","text-sm","text-slate-500","dark:text-slate-400"],["name","loader",1,"w-4","h-4","animate-spin"],[1,"px-4","py-3","border-t","border-gray-200","dark:border-slate-800","text-xs","text-slate-600","dark:text-slate-400","bg-gray-50","dark:bg-slate-900"],[1,"hover:bg-gray-50","dark:hover:bg-slate-800/50"],[1,"py-2.5","px-4"],[1,"flex","items-center","gap-3"],[1,"h-8","w-8","rounded-full","bg-linear-to-br","from-sky-500","to-emerald-400","flex","items-center","justify-center","text-xs","font-semibold","tracking-tight","text-white"],[1,"text-sm","text-slate-900","dark:text-slate-100"],[1,"text-xs","text-slate-500","dark:text-slate-400"],[1,"py-2.5","px-4","text-sm","text-slate-700","dark:text-slate-300"],[1,"inline-flex","items-center","gap-1","rounded-full","px-2.5","py-0.5","text-xs","border","cursor-pointer",3,"click","ngClass"],[1,"h-1.5","w-1.5","rounded-full",3,"ngClass"],[1,"py-2.5","px-4","text-right"],[1,"inline-flex","items-center","gap-2"],[1,"inline-flex","items-center","gap-1","text-xs","text-slate-700","dark:text-slate-300","border","border-gray-300","dark:border-slate-700","rounded-lg","px-2.5","py-1","hover:bg-gray-100","dark:hover:bg-slate-800",3,"click"],[1,"ml-2","inline-flex","items-center","gap-1","text-xs","text-rose-600","dark:text-rose-400","hover:text-rose-700","dark:hover:text-rose-300",3,"click"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h2",5),s(6,"Recent users"),n(),r(7,"p",6),s(8,"Last access events across your workspace."),n()(),r(9,"div",7)(10,"button",8),c("click",function(){return i.filter=i.filter==="active"?"all":"active"}),p(11,"lucide-angular",9),r(12,"span"),s(13),n()(),r(14,"button",10),c("click",function(){return i.openAdd()}),p(15,"lucide-angular",11),s(16," New user "),n()()(),r(17,"div",12),c("scroll",function(o){return i.onScroll(o)}),r(18,"table",13)(19,"thead",14)(20,"tr")(21,"th",15),s(22,"User"),n(),r(23,"th",15),s(24,"Role"),n(),r(25,"th",15),s(26,"Last active"),n(),r(27,"th",15),s(28,"Status"),n(),r(29,"th",16),s(30,"Actions"),n()()(),r(31,"tbody",17),k(32,j,24,16,"tr",18),n()(),r(33,"div",19),p(34,"lucide-angular",20),n()(),r(35,"div",21)(36,"span"),s(37),n()()()()()),e&2&&(a(13),m(i.filter==="active"?"Active only":"Filters"),a(19),v("ngForOf",i.displayedUsers),a(5),_("Showing ",i.displayedUsers.length," of ",i.filtered.length," users"))},dependencies:[U,C,w,E,I],encapsulation:2})};export{T as a};
