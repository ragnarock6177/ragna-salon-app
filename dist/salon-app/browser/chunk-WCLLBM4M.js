import{a as D,b as M}from"./chunk-RTAZCOS2.js";import{q as E,w as A}from"./chunk-6EJ6NX7I.js";import"./chunk-A5XTOKYI.js";import"./chunk-R6TD3WNB.js";import{Ab as p,Ga as l,Jc as I,Kc as L,Nb as a,Ob as b,Pa as x,Pb as v,Qb as _,Va as y,Yb as h,Za as C,ca as u,da as g,mb as f,nb as r,ob as n,pb as m,vc as S,wb as k,wc as w,yb as c,zc as U}from"./chunk-2QRLZU6U.js";var O=(o,t,e)=>({"bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400 border-emerald-300 dark:border-emerald-700":o,"bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400 border-amber-300 dark:border-amber-700":t,"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-400 border-gray-300 dark:border-gray-700":e}),F=(o,t,e)=>({"bg-emerald-500":o,"bg-amber-500":t,"bg-gray-500":e});function j(o,t){if(o&1){let e=k();r(0,"tr",20)(1,"td",21)(2,"div",22)(3,"div",23),a(4),n(),r(5,"div",4)(6,"span",24),a(7),n()()()(),r(8,"td",21)(9,"span",25),c("click",function(){let d=u(e).index,s=p();return g(s.toggleStatus(s.getOriginalIndex(d)))}),m(10,"span",26),a(11),n()(),r(12,"td",21)(13,"div",27)(14,"button",28),c("click",function(){let d=u(e).index,s=p();return g(s.edit(s.getOriginalIndex(d)))}),a(15,"Manage"),n(),r(16,"button",29),c("click",function(){let d=u(e).index,s=p();return g(s.delete(s.getOriginalIndex(d)))}),a(17,"Delete"),n()()()()}if(o&2){let e=t.$implicit,i=p();l(4),v(" ",i.getName(e)),l(3),b(e.name),l(2),f("ngClass",h(5,O,e.active==="Active",e.active==="Pending",e.active==="Inactive")),l(),f("ngClass",h(9,F,e.active==="Active",e.active==="Pending",e.active==="Inactive")),l(),v(" ",e.active," ")}}var T=class o{constructor(t,e,i){this.userSrv=t;this.dialog=e;this.confirmationService=i}users=[];displayedUsers=[];filter="all";search="";loading=!1;itemsPerLoad=10;currentLoadedCount=0;modalSubscription;ngOnInit(){this.users=this.userSrv.list(),this.loadInitialUsers(),this.modalSubscription=this.userSrv.onOpenModal.subscribe(t=>{t!==null&&this.openDialog(t)})}ngOnDestroy(){this.modalSubscription?.unsubscribe()}loadInitialUsers(){this.currentLoadedCount=Math.min(this.itemsPerLoad,this.filtered.length),this.displayedUsers=this.filtered.slice(0,this.currentLoadedCount)}loadMoreUsers(){this.loading||this.currentLoadedCount>=this.filtered.length||(this.loading=!0,setTimeout(()=>{let t=Math.min(this.currentLoadedCount+this.itemsPerLoad,this.filtered.length);this.displayedUsers=this.filtered.slice(0,t),this.currentLoadedCount=t,this.loading=!1},300))}onScroll(t){let e=t.target;e.scrollHeight-e.scrollTop<=e.clientHeight+50&&this.loadMoreUsers()}openDialog(t){this.dialog.open(M,{width:"600px",maxWidth:"90vw",data:t,panelClass:"custom-dialog-container",disableClose:!1}).afterClosed().subscribe(i=>{i&&(this.users=this.userSrv.list(),this.loadInitialUsers())})}get filtered(){let t=[...this.users];if(this.filter==="active"&&(t=t.filter(e=>e.active==="Active")),this.search){let e=this.search.toLowerCase();t=t.filter(i=>i.name.toLowerCase().includes(e)||i.email.toLowerCase().includes(e)||i.role.toLowerCase().includes(e))}return t}openAdd(){this.userSrv.openAdd()}edit(t){this.userSrv.openEdit(t)}delete(t){let e=this.users[t];this.confirmationService.confirm({title:"Delete User",message:`Are you sure you want to delete ${e.name}? This action cannot be undone.`,confirmText:"Delete",type:"danger"}).subscribe(i=>{i&&(this.userSrv.remove(t),this.users=this.userSrv.list(),this.loadInitialUsers())})}toggleStatus(t){this.userSrv.toggleStatus(t),this.displayedUsers=this.filtered.slice(0,this.currentLoadedCount)}getOriginalIndex(t){let e=this.displayedUsers[t];return this.users.findIndex(i=>i===e)}getName(t){return t.name.split(" ").map(e=>e[0]).slice(0,2).join("").toUpperCase()}static \u0275fac=function(e){return new(e||o)(x(D),x(E),x(A))};static \u0275cmp=y({type:o,selectors:[["app-city"]],decls:32,vars:4,consts:[[1,"grid","grid-cols-1","xl:grid-cols-3","gap-4"],[1,"xl:col-span-3"],[1,"rounded-2xl","border","border-gray-200","dark:border-slate-800","bg-white","dark:bg-slate-900","overflow-hidden","flex","flex-col","shadow-sm","transition-colors"],[1,"flex","items-center","justify-between","px-4","py-3","border-b","border-gray-200","dark:border-slate-800"],[1,"flex","flex-col"],[1,"text-base","font-semibold","tracking-tight","text-slate-900","dark:text-slate-100"],[1,"flex","items-center","gap-2"],[1,"hidden","sm:inline-flex","items-center","gap-1.5","rounded-lg","border","border-gray-300","dark:border-slate-700","px-3","py-1.5","text-xs","text-slate-700","dark:text-slate-300","hover:bg-gray-100","dark:hover:bg-slate-800",3,"click"],["name","funnel",1,"w-3.5","h-3.5"],[1,"inline-flex","items-center","gap-1.5","rounded-lg","bg-sky-600","hover:bg-sky-700","text-white","text-xs","font-medium","px-3","py-1.5","transition",3,"click"],["name","plus",1,"w-3.5","h-3.5"],[1,"overflow-auto",2,"max-height","calc(100dvh - 222px)",3,"scroll"],[1,"w-full","text-sm","overflow-auto"],[1,"bg-gray-50","dark:bg-slate-900","border-b","border-gray-200","dark:border-slate-800","text-xs","text-slate-700","dark:text-slate-300","sticky","top-0"],[1,"text-left","font-medium","py-2.5","px-4"],[1,"divide-y","divide-gray-200","dark:divide-slate-800"],["class","hover:bg-gray-50 dark:hover:bg-slate-800/50",4,"ngFor","ngForOf"],[1,"flex","justify-center","py-4","text-center","text-sm","text-slate-500","dark:text-slate-400"],["name","loader",1,"w-4","h-4","animate-spin"],[1,"px-4","py-3","border-t","border-gray-200","dark:border-slate-800","text-xs","text-slate-600","dark:text-slate-400","bg-gray-50","dark:bg-slate-900"],[1,"hover:bg-gray-50","dark:hover:bg-slate-800/50"],[1,"py-2.5","px-4"],[1,"flex","items-center","gap-3"],[1,"h-8","w-8","rounded-full","bg-linear-to-br","from-sky-500","to-emerald-400","flex","items-center","justify-center","text-xs","font-semibold","tracking-tight","text-white"],[1,"text-sm","text-slate-900","dark:text-slate-100"],[1,"inline-flex","items-center","gap-1","rounded-full","px-2.5","py-0.5","text-xs","border","cursor-pointer",3,"click","ngClass"],[1,"h-1.5","w-1.5","rounded-full",3,"ngClass"],[1,"inline-flex","items-center","gap-2"],[1,"inline-flex","items-center","gap-1","text-xs","text-slate-700","dark:text-slate-300","border","border-gray-300","dark:border-slate-700","rounded-lg","px-2.5","py-1","hover:bg-gray-100","dark:hover:bg-slate-800",3,"click"],[1,"ml-2","inline-flex","items-center","gap-1","text-xs","text-rose-600","dark:text-rose-400","hover:text-rose-700","dark:hover:text-rose-300",3,"click"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h2",5),a(6,"Cities "),n()(),r(7,"div",6)(8,"button",7),c("click",function(){return i.filter=i.filter==="active"?"all":"active"}),m(9,"lucide-angular",8),r(10,"span"),a(11),n()(),r(12,"button",9),c("click",function(){return i.openAdd()}),m(13,"lucide-angular",10),a(14," Add City "),n()()(),r(15,"div",11),c("scroll",function(s){return i.onScroll(s)}),r(16,"table",12)(17,"thead",13)(18,"tr")(19,"th",14),a(20,"City"),n(),r(21,"th",14),a(22,"Status"),n(),r(23,"th",14),a(24,"Actions"),n()()(),r(25,"tbody",15),C(26,j,18,13,"tr",16),n()(),r(27,"div",17),m(28,"lucide-angular",18),n()(),r(29,"div",19)(30,"span"),a(31),n()()()()()),e&2&&(l(11),b(i.filter==="active"?"Active only":"Filters"),l(15),f("ngForOf",i.displayedUsers),l(5),_("Showing ",i.displayedUsers.length," of ",i.filtered.length," users"))},dependencies:[U,S,w,L,I],encapsulation:2})};export{T as CityComponent};
